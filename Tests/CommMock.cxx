///////////////////////////////////////////////////////////////////////////////
//////////////////////////////// INCLUDES /////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#include "Utils.h"
#include "CommMock.hxx"

///////////////////////////////////////////////////////////////////////////////
//////////////////////////////// VARIABLES ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

using ::testing::AtLeast;
using ::testing::Return;

///////////////////////////////////////////////////////////////////////////////
//////////////////////////////// FUNCTIONS ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

TEST_F (CommFixture, ChecksSwitchingBetweenSendAndReceive)
{
    EXPECT_CALL (commMock, send    ()).Times (2);
    EXPECT_CALL (commMock, receive ()).Times (2);

    for (uint8_t iteration = 0; iteration < 4; iteration++)
    {
        commMock.Process ();

        if ((iteration == 0) || (iteration == 2))
        {
            commMock.SetState (Communication::EState::eSend);
        }
        else
        {
            commMock.SetState (Communication::EState::eReceive);
        }
    }
}

///////////////////////////////////////////////////////////////////////////////
/////////////////////////////// END OF FILE ///////////////////////////////////
///////////////////////////////////////////////////////////////////////////////